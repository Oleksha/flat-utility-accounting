## –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π —à–∞–±–ª–æ–Ω –¥–∞—à–±–æ—Ä–¥–∞ —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏, —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ id –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –º–∞—Å—Å–∏–≤–∞–º–∏

–•–æ—á—É.

–û—Ç–ª–∏—á–Ω–æ! –ù–∏–∂–µ ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤—ã–π, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π, **—Ä–∞–±–æ—á–∏–π –¥–∞—à–±–æ—Ä–¥** –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã `/`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:

* –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–≤–∞—Ä—Ç–∏—Ä
* –≥—Ä–∞—Ñ–∏–∫–∏ ¬´–ù–∞—á–∏—Å–ª–µ–Ω–∏—è vs –ü–ª–∞—Ç–µ–∂–∏¬ª –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 12 –º–µ—Å—è—Ü–µ–≤
* –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Bootstrap
* –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ Chart.js

---

# ‚úÖ **1. –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä ‚Äî DashboardController.php**

–°–æ–∑–¥–∞—ë–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä:

```php
php artisan make:controller DashboardController
```

–ò –Ω–∞–ø–æ–ª–Ω—è–µ–º:

```php
<?php

namespace App\Http\Controllers;

use App\Models\Apartment;
use Illuminate\Http\Request;

class DashboardController extends Controller
{
    public function index()
    {
        $apartments = Apartment::with(['charges', 'payments'])->get();

        foreach ($apartments as $apartment) {
            // –°–æ–±–∏—Ä–∞–µ–º –º–µ—Å—è—Ü—ã
            $months = collect(range(0, 11))
                ->map(fn($i) => now()->subMonths($i)->format('Y-m'))
                ->reverse()
                ->values();

            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è
            $chargesGrouped = $apartment->charges
                ->groupBy(fn($item) => $item->period->format('Y-m'))
                ->map(fn($group) => $group->sum('amount'));

            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–ª–∞—Ç–µ–∂–∏
            $paymentsGrouped = $apartment->payments
                ->groupBy(fn($item) => $item->payment_date->format('Y-m'))
                ->map(fn($group) => $group->sum('amount'));

            // –§–æ—Ä–º–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
            $apartment->chartLabels = $months->map(
                fn($m) => \Carbon\Carbon::createFromFormat('Y-m', $m)->format('M Y')
            )->toArray();

            $apartment->chartCharges = $months->map(
                fn($m) => $chargesGrouped[$m] ?? 0
            )->toArray();

            $apartment->chartPayments = $months->map(
                fn($m) => $paymentsGrouped[$m] ?? 0
            )->toArray();
        }

        return view('dashboard', compact('apartments'));
    }
}
```

---

# ‚úÖ **2. –ú–∞—Ä—à—Ä—É—Ç ‚Äî web.php**

```php
Route::get('/', [DashboardController::class, 'index'])->name('dashboard');
```

---

# ‚úÖ **3. –®–∞–±–ª–æ–Ω Dashboard ‚Äî resources/views/dashboard.blade.php**

–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—á–∏–π, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π layout:

```blade
@extends('layouts.app')

@section('content')
<div class="container">
    <h1 class="mb-4">–î–∞—à–±–æ—Ä–¥ –∫–≤–∞—Ä—Ç–∏—Ä</h1>

    <div class="row">
        @foreach ($apartments as $apartment)
            <div class="col-md-6 mb-4">
                <div class="card shadow-sm">
                    <div class="card-header">
                        <h5 class="mb-0">{{ $apartment->name }}</h5>
                        <small class="text-muted">{{ $apartment->address }}</small>
                    </div>

                    <div class="card-body">
                        <canvas id="chart-{{ $apartment->id }}" height="120"></canvas>
                    </div>

                    <div class="card-footer text-end">
                        <a href="{{ route('apartments.show', $apartment->id) }}" class="btn btn-primary btn-sm">
                            –û—Ç–∫—Ä—ã—Ç—å ‚Üí
                        </a>
                    </div>
                </div>
            </div>
        @endforeach
    </div>
</div>
@endsection

@push('scripts')
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {

            @foreach ($apartments as $apartment)
                const ctx{{ $apartment->id }} = document
                    .getElementById('chart-{{ $apartment->id }}')
                    .getContext('2d');

                new Chart(ctx{{ $apartment->id }}, {
                    type: 'line',
                    data: {
                        labels: @json($apartment->chartLabels),
                        datasets: [
                            {
                                label: '–ù–∞—á–∏—Å–ª–µ–Ω–∏—è',
                                data: @json($apartment->chartCharges),
                                borderWidth: 2,
                                tension: 0.3
                            },
                            {
                                label: '–ü–ª–∞—Ç–µ–∂–∏',
                                data: @json($apartment->chartPayments),
                                borderWidth: 2,
                                tension: 0.3
                            }
                        ]
                    },
                });
            @endforeach

        });
    </script>
@endpush
```

---

# ‚úÖ **4. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ layout ‚Äî layouts/app.blade.php**

–ü–µ—Ä–µ–¥ `</body>` –î–û–õ–ñ–ù–û –±—ã—Ç—å:

```blade
@stack('scripts')
```

–ü–æ–ª–Ω—ã–π –Ω–∏–∑ layout:

```blade
    @stack('scripts')
</body>
</html>
```

---

# üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –≥—Ä–∞—Ñ–∏–∫–∏ **—Ç–æ—á–Ω–æ** –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å:

‚úî —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ ID
‚úî –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON
‚úî Chart.js –ø–æ–¥–∫–ª—é—á—ë–Ω
‚úî —Å–∫—Ä–∏–ø—Ç—ã –∑–∞–≥—Ä—É–∑—è—Ç—Å—è —á–µ—Ä–µ–∑ stack
‚úî –¥–∞–Ω–Ω—ã–µ —Å–æ–±—Ä–∞–Ω—ã –∏–∑ –º–æ–¥–µ–ª–µ–π –∏ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ –º–∞—Å—Å–∏–≤–∞–º

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –º–æ–≥—É —Å–¥–µ–ª–∞—Ç—å:

* –∫—Ä–∞—Å–∏–≤—É—é —Ü–≤–µ—Ç–æ–≤—É—é —Ç–µ–º—É
* —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–º–µ—â–µ–Ω–∏–π –ø–æ —Å—É–º–º–∞–º
* –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –∏—Ç–æ–≥–∞–º–∏ –∑–∞ –º–µ—Å—è—Ü
* –≤—ã–≤–æ–¥ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π
* –º–æ–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å—Ç–∫—É
* —Ç—ë–º–Ω—É—é —Ç–µ–º—É

–ß—Ç–æ –¥–µ–ª–∞–µ–º –¥–∞–ª—å—à–µ?

---

[–ü—Ä–µ–¥—ã–¥—É—â–∞—è —á–∞—Å—Ç—å](20.md) | [–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](01.md) | [–°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å](22.md)



## –ú–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π

–û—Ç–ª–∏—á–Ω–æ üî•
**–ú–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π –Ω–∞ –º–µ—Å—è—Ü** ‚Äî —ç—Ç–æ —É–∂–µ —É—Ä–æ–≤–µ–Ω—å –Ω–∞—Å—Ç–æ—è—â–µ–π –±–∏–ª–ª–∏–Ω–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã.

–°–¥–µ–ª–∞–µ–º **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É–¥–æ–±–Ω–æ**, –±–µ–∑ —Å–ª–æ–∂–Ω–æ–π –º–∞–≥–∏–∏.

---

# üéØ –ö–∞–∫ —ç—Ç–æ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å (UX)

–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ **¬´–î–æ–±–∞–≤–∏—Ç—å –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è¬ª**:

* –≤—ã–±–∏—Ä–∞–µ—à—å:

    * –∫–≤–∞—Ä—Ç–∏—Ä—É
    * –º–µ—Å—è—Ü + –≥–æ–¥
* –Ω–∏–∂–µ ‚Äî **—Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö —É—Å–ª—É–≥ —ç—Ç–æ–π –∫–≤–∞—Ä—Ç–∏—Ä—ã**
* –¥–ª—è –∫–∞–∂–¥–æ–π —É—Å–ª—É–≥–∏:

    * –ø–æ–ª–µ ¬´–°—É–º–º–∞¬ª
* –∫–Ω–æ–ø–∫–∞:

  > üíæ **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è**

üëâ –ó–∞ **1 —ç–∫—Ä–∞–Ω** –≤–Ω–æ—Å–∏—à—å –≤—Å–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∑–∞ –º–µ—Å—è—Ü.

---

# üß© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

* —É—Å–ª—É–≥–∏ —É–∂–µ –µ—Å—Ç—å ‚úî
* —Ç–∞—Ä–∏—Ñ—ã –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ (–ø–æ–∫–∞ –≤—Ä—É—á–Ω—É—é)
* —Å–æ–∑–¥–∞—ë–º **–æ–¥–Ω—É —Ñ–æ—Ä–º—É**
* —Å–æ—Ö—Ä–∞–Ω—è–µ–º **–Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π charges**

---

# ‚úÖ –®–ê–ì 1. –ú–∞—Ä—à—Ä—É—Ç

`routes/web.php`

```php
Route::get('/charges/bulk/create', [ChargeController::class, 'bulkCreate'])
    ->name('charges.bulk.create');

Route::post('/charges/bulk/store', [ChargeController::class, 'bulkStore'])
    ->name('charges.bulk.store');
```

---

# ‚úÖ –®–ê–ì 2. –ú–µ—Ç–æ–¥—ã –≤ ChargeController

```php
use App\Models\Service;
use Carbon\Carbon;

public function bulkCreate(Request $request)
{
    return view('charges.bulk-create', [
        'services'    => Service::all(),
        'apartments'  => Apartment::all(),
        'month'       => $request->get('month', now()->month),
        'year'        => $request->get('year', now()->year),
        'apartmentId' => $request->get('apartment_id'),
    ]);
}
```

```php
public function bulkStore(Request $request)
{
    $data = $request->validate([
        'apartment_id'      => 'required|exists:apartments,id',
        'month'             => 'required|integer|min:1|max:12',
        'year'              => 'required|integer',
        'charges'           => 'required|array',
        'charges.*.service' => 'required|exists:services,id',
        'charges.*.amount'  => 'nullable|numeric|min:0',
    ]);

    $period = Carbon::create($data['year'], $data['month'], 1);

    foreach ($data['charges'] as $charge) {

        if ($charge['amount'] === null || $charge['amount'] == 0) {
            continue;
        }

        // –∑–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–µ–π
        $exists = Charge::where([
            'apartment_id' => $data['apartment_id'],
            'service_id'   => $charge['service'],
            'period'       => $period,
        ])->exists();

        if ($exists) {
            continue;
        }

        Charge::create([
            'apartment_id' => $data['apartment_id'],
            'service_id'   => $charge['service'],
            'amount'       => $charge['amount'],
            'period'       => $period,
        ]);
    }

    return redirect()
        ->route('apartments.show', $data['apartment_id'])
        ->with('success', '–ù–∞—á–∏—Å–ª–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
}
```

---

# ‚úÖ –®–ê–ì 3. –®–∞–±–ª–æ–Ω bulk-—Ñ–æ—Ä–º—ã

`resources/views/charges/bulk-create.blade.php`

```blade
@extends('layouts.app')

@section('content')
<div class="container">
    <h2 class="mb-4">–ù–∞—á–∏—Å–ª–µ–Ω–∏—è –∑–∞ –º–µ—Å—è—Ü</h2>

    <form method="POST" action="{{ route('charges.bulk.store') }}">
        @csrf

        {{-- –ö–≤–∞—Ä—Ç–∏—Ä–∞ --}}
        <div class="row mb-3">
            <div class="col-md-4">
                <label class="form-label">–ö–≤–∞—Ä—Ç–∏—Ä–∞</label>
                <select name="apartment_id" class="form-select" required>
                    @foreach($apartments as $apartment)
                        <option value="{{ $apartment->id }}"
                            {{ $apartmentId == $apartment->id ? 'selected' : '' }}>
                            {{ $apartment->name }} ‚Äî {{ $apartment->address }}
                        </option>
                    @endforeach
                </select>
            </div>

            {{-- –ú–µ—Å—è—Ü --}}
            <div class="col-md-4">
                <label class="form-label">–ú–µ—Å—è—Ü</label>
                <select name="month" class="form-select">
                    @foreach(range(1,12) as $m)
                        <option value="{{ $m }}" {{ $month == $m ? 'selected' : '' }}>
                            {{ \Carbon\Carbon::create()->month($m)->translatedFormat('F') }}
                        </option>
                    @endforeach
                </select>
            </div>

            {{-- –ì–æ–¥ --}}
            <div class="col-md-4">
                <label class="form-label">–ì–æ–¥</label>
                <select name="year" class="form-select">
                    @foreach(range(now()->year, now()->year - 5) as $y)
                        <option value="{{ $y }}" {{ $year == $y ? 'selected' : '' }}>
                            {{ $y }}
                        </option>
                    @endforeach
                </select>
            </div>
        </div>

        {{-- –¢–∞–±–ª–∏—Ü–∞ —É—Å–ª—É–≥ --}}
        <table class="table table-bordered">
            <thead class="table-light">
                <tr>
                    <th>–£—Å–ª—É–≥–∞</th>
                    <th width="200">–°—É–º–º–∞</th>
                </tr>
            </thead>
            <tbody>
                @foreach($services as $i => $service)
                    <tr>
                        <td>{{ $service->name }}</td>
                        <td>
                            <input type="hidden"
                                   name="charges[{{ $i }}][service]"
                                   value="{{ $service->id }}">

                            <input type="number"
                                   step="0.01"
                                   min="0"
                                   class="form-control"
                                   name="charges[{{ $i }}][amount]"
                                   placeholder="‚Äî">
                        </td>
                    </tr>
                @endforeach
            </tbody>
        </table>

        <div class="text-end">
            <button class="btn btn-success">
                üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è
            </button>
        </div>
    </form>
</div>
@endsection
```

---

# üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å —Ç—ã –º–æ–∂–µ—à—å:

‚úî –∑–∞ **1 —Ñ–æ—Ä–º—É** –≤–Ω–µ—Å—Ç–∏ –≤—Å–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è
‚úî –Ω–µ –æ—à–∏–±–∏—Ç—å—Å—è —Å –ø–µ—Ä–∏–æ–¥–æ–º
‚úî –Ω–µ —Å–æ–∑–¥–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã
‚úî —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –ñ–ö–•

---

# üöÄ –°–ª–µ–¥—É—é—â–∏–π –º–æ—â–Ω—ã–π —à–∞–≥ (—Ä–µ–∫–æ–º–µ–Ω–¥—É—é)

1Ô∏è‚É£ **–¢–∞—Ä–∏—Ñ—ã –ø–æ —É—Å–ª—É–≥–∞–º (–∞–≤—Ç–æ–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—É–º–º)**
2Ô∏è‚É£ **–ü–ª–∞–Ω–æ–≤—ã–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è (—à–∞–±–ª–æ–Ω—ã)**
3Ô∏è‚É£ **–ê–≤—Ç–æ–∑–∞—á—ë—Ç –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ –¥–æ–ª–≥–∞–º**
4Ô∏è‚É£ **–≠–∫—Å–ø–æ—Ä—Ç Excel**

–í—ã–±–∏—Ä–∞–π –Ω–æ–º–µ—Ä ‚Äî –¥–≤–∏–≥–∞–µ–º—Å—è –¥–∞–ª—å—à–µ üí™

---

[–ü—Ä–µ–¥—ã–¥—É—â–∞—è —á–∞—Å—Ç—å](36.md) | [–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](01.md) | [–°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å](38.md)



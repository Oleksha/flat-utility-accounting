## –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–∞ –∑–∞ –≥–æ–¥ (PDF)

–û—Ç–ª–∏—á–Ω–æ üëç

–î–µ–ª–∞–µ–º **—ç–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–∞ –∑–∞ –≥–æ–¥**. –ù–∞—á–Ω—ë–º —Å **PDF-–æ—Ç—á—ë—Ç–∞ –ø–æ –∫–≤–∞—Ä—Ç–∏—Ä–µ** ‚Äî —ç—Ç–æ —Å–∞–º—ã–π –≤–æ—Å—Ç—Ä–µ–±–æ–≤–∞–Ω–Ω—ã–π –∏ –ª–æ–≥–∏—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç.
(Excel –¥–æ–±–∞–≤–∏–º —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º, –æ–Ω –¥–µ–ª–∞–µ—Ç—Å—è –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ.)

---

## üéØ –ß—Ç–æ –±—É–¥–µ—Ç –≤ PDF-–æ—Ç—á—ë—Ç–µ

**–û—Ç—á—ë—Ç –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–¥ –ø–æ –∫–≤–∞—Ä—Ç–∏—Ä–µ:**

* –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –∞–¥—Ä–µ—Å –∫–≤–∞—Ä—Ç–∏—Ä—ã
* –≥–æ–¥ –æ—Ç—á—ë—Ç–∞
* –∏—Ç–æ–≥–∏ –∑–∞ –≥–æ–¥:

    * –Ω–∞—á–∏—Å–ª–µ–Ω–æ
    * –æ–ø–ª–∞—á–µ–Ω–æ
    * –¥–æ–ª–≥ / –ø–µ—Ä–µ–ø–ª–∞—Ç–∞
* —Ç–∞–±–ª–∏—Ü–∞ –ø–æ –º–µ—Å—è—Ü–∞–º:

    * –º–µ—Å—è—Ü
    * –Ω–∞—á–∏—Å–ª–µ–Ω–æ
    * –æ–ø–ª–∞—á–µ–Ω–æ
    * –±–∞–ª–∞–Ω—Å
* –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π, –ø–µ—á–∞—Ç–Ω—ã–π –≤–∏–¥ (A4)

---

# ‚úÖ –®–ê–ì 1. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º DomPDF

```bash
composer require barryvdh/laravel-dompdf
```

Laravel 9+ ‚Äî —Å–µ—Ä–≤–∏—Å-–ø—Ä–æ–≤–∞–π–¥–µ—Ä —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

---

# ‚úÖ –®–ê–ì 2. –ú–∞—Ä—à—Ä—É—Ç –¥–ª—è PDF

`routes/web.php`

```php
Route::get(
    '/apartments/{apartment}/report/pdf',
    [ApartmentController::class, 'pdfReport']
)->name('apartments.report.pdf');
```

---

# ‚úÖ –®–ê–ì 3. –ú–µ—Ç–æ–¥ –≤ ApartmentController

–î–æ–±–∞–≤–ª—è–µ–º **–Ω–æ–≤—ã–π –º–µ—Ç–æ–¥**, –Ω–µ —Ç—Ä–æ–≥–∞—è `show()`:

```php
use Barryvdh\DomPDF\Facade\Pdf;

public function pdfReport(Apartment $apartment)
{
    $year = request()->get('year', now()->year);

    $charges = $apartment->charges()
        ->whereYear('period', $year)
        ->get()
        ->groupBy(fn($c) => $c->period->format('Y-m'));

    $payments = $apartment->payments()
        ->whereYear('payment_date', $year)
        ->get()
        ->groupBy(fn($p) => $p->payment_date->format('Y-m'));

    // –º–µ—Å—è—Ü—ã –≥–æ–¥–∞
    $months = collect(range(1, 12))
        ->map(fn($m) => sprintf('%d-%02d', $year, $m));

    // —Å–≤–æ–¥–∫–∞ –ø–æ –º–µ—Å—è—Ü–∞–º
    $rows = $months->map(function ($m) use ($charges, $payments) {
        $charged = ($charges[$m] ?? collect())->sum('amount');
        $paid    = ($payments[$m] ?? collect())->sum('amount');

        return [
            'month'   => $m,
            'charged' => $charged,
            'paid'    => $paid,
            'balance' => $charged - $paid,
        ];
    });

    $totalCharged = $rows->sum('charged');
    $totalPaid    = $rows->sum('paid');
    $totalBalance = $totalCharged - $totalPaid;

    $pdf = Pdf::loadView('apartments.reports.year', [
        'apartment'     => $apartment,
        'year'          => $year,
        'rows'          => $rows,
        'totalCharged'  => $totalCharged,
        'totalPaid'     => $totalPaid,
        'totalBalance'  => $totalBalance,
    ])->setPaper('a4');

    return $pdf->download("–û—Ç—á–µ—Ç_{$apartment->name}_{$year}.pdf");
}
```

---

# ‚úÖ –®–ê–ì 4. Blade-—à–∞–±–ª–æ–Ω PDF

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª
`resources/views/apartments/reports/year.blade.php`

```blade
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: DejaVu Sans; font-size: 12px; }
        h1, h2 { margin-bottom: 5px; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { border: 1px solid #ccc; padding: 6px; text-align: right; }
        th { background: #f2f2f2; }
        td:first-child, th:first-child { text-align: left; }
        .summary td { font-weight: bold; }
    </style>
</head>
<body>

<h1>–û—Ç—á—ë—Ç –ø–æ –∫–≤–∞—Ä—Ç–∏—Ä–µ</h1>
<h2>{{ $apartment->name }}</h2>
<p>{{ $apartment->address }}</p>
<p><strong>–ì–æ–¥:</strong> {{ $year }}</p>

<table>
    <thead>
        <tr>
            <th>–ú–µ—Å—è—Ü</th>
            <th>–ù–∞—á–∏—Å–ª–µ–Ω–æ</th>
            <th>–û–ø–ª–∞—á–µ–Ω–æ</th>
            <th>–ë–∞–ª–∞–Ω—Å</th>
        </tr>
    </thead>
    <tbody>
        @foreach($rows as $row)
            <tr>
                <td>
                    {{ \Carbon\Carbon::createFromFormat('Y-m', $row['month'])->translatedFormat('F Y') }}
                </td>
                <td>{{ number_format($row['charged'], 2, ',', ' ') }}</td>
                <td>{{ number_format($row['paid'], 2, ',', ' ') }}</td>
                <td>{{ number_format($row['balance'], 2, ',', ' ') }}</td>
            </tr>
        @endforeach
    </tbody>
    <tfoot>
        <tr class="summary">
            <td>–ò—Ç–æ–≥–æ</td>
            <td>{{ number_format($totalCharged, 2, ',', ' ') }}</td>
            <td>{{ number_format($totalPaid, 2, ',', ' ') }}</td>
            <td>{{ number_format($totalBalance, 2, ',', ' ') }}</td>
        </tr>
    </tfoot>
</table>

</body>
</html>
```

---

# ‚úÖ –®–ê–ì 5. –ö–Ω–æ–ø–∫–∞ ¬´–°–∫–∞—á–∞—Ç—å PDF¬ª –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

–í–æ –≤–∫–ª–∞–¥–∫–µ **üìä –û–±–∑–æ—Ä** (–Ω–∞–ø—Ä–∏–º–µ—Ä —Ä—è–¥–æ–º —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π):

```blade
<a href="{{ route('apartments.report.pdf', [
        'apartment' => $apartment->id,
        'year' => $year
    ]) }}"
   class="btn btn-outline-dark mb-3">
    üìÑ –°–∫–∞—á–∞—Ç—å PDF-–æ—Ç—á—ë—Ç
</a>
```

---

# üéâ –ò—Ç–æ–≥

–¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è:

‚úî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π PDF-–æ—Ç—á—ë—Ç
‚úî –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–¥
‚úî —Å –∏—Ç–æ–≥–∞–º–∏ –∏ –ø–æ–º–µ—Å—è—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π
‚úî –≥–æ—Ç–æ–≤—ã–π –¥–ª—è –ø–µ—á–∞—Ç–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏

---

## üîú –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ (–æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ)

üëâ **Excel-—ç–∫—Å–ø–æ—Ä—Ç** (1 —Ñ–∞–π–ª = 1 –≥–æ–¥ = 1 –∫–≤–∞—Ä—Ç–∏—Ä–∞)
–∏–ª–∏
üëâ **–û–±—â–∏–π PDF –ø–æ –≤—Å–µ–º –∫–≤–∞—Ä—Ç–∏—Ä–∞–º**

–°–∫–∞–∂–∏, —á—Ç–æ –¥–µ–ª–∞–µ–º –¥–∞–ª—å—à–µ ‚Äî –ø—Ä–æ–µ–∫—Ç —É–∂–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ üöÄ

---

[–ü—Ä–µ–¥—ã–¥—É—â–∞—è —á–∞—Å—Ç—å](33.md) | [–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](01.md) | [–°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å](35.md)



## –í—ã–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –∑–∞ —Ç–µ–∫—É—â–∏–π –≥–æ–¥

–õ—É—á—à–µ —Å–¥–µ–ª–∞–π —á—Ç–æ–±—ã Blade-—à–∞–±–ª–æ–Ω –≤—ã–≤–æ–¥–∏–ª –¥–∞–Ω–Ω—ã–µ –∑–∞ —Ç–µ–∫—É—â–∏–π –≥–æ–¥ –∏ –±—ã–ª–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞–Ω–Ω—ã–µ –∑–∞ –¥—Ä—É–≥–∏–µ –≥–æ–¥–∞.

–û—Ç–ª–∏—á–Ω–æ ‚Äî —Å–¥–µ–ª–∞–µ–º **—Ñ–∏–ª—å—Ç—Ä –ø–æ –≥–æ–¥–∞–º**, –≥–¥–µ:

‚úî –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è **—Ç–µ–∫—É—â–∏–π –≥–æ–¥**
‚úî —Å–≤–µ—Ä—Ö—É –≤—ã–≤–æ–¥–∏—Ç—Å—è **—Å–ø–∏—Å–æ–∫ –≥–æ–¥–æ–≤** (–∫–Ω–æ–ø–∫–∏ –∏–ª–∏ –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫)
‚úî Blade –≤—ã–≤–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Ç–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∏ –ø–ª–∞—Ç–µ–∂–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –≥–æ–¥—É
‚úî –ø–µ—Ä–µ—Ö–æ–¥ –º–µ–∂–¥—É –≥–æ–¥–∞–º–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ GET-–ø–∞—Ä–∞–º–µ—Ç—Ä `?year=2025`

---

# ‚úÖ 1. –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä ‚Äî —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≥–æ–¥—É

```php
public function show(Apartment $apartment)
{
    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–¥ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî —Ç–µ–∫—É—â–∏–π)
    $year = request()->get('year', now()->year);

    // –í—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≥–æ–¥–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∏–ª–∏ –ø–ª–∞—Ç–µ–∂–∏
    $years = collect()
        ->merge($apartment->charges->pluck('period')->map->year)
        ->merge($apartment->payments->pluck('payment_date')->map->year)
        ->unique()
        ->sortDesc()
        ->values();

    // –§–∏–ª—å—Ç—Ä—É–µ–º –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –ø–æ –≥–æ–¥—É
    $charges = $apartment->charges
        ->filter(fn($c) => $c->period->year == $year)
        ->sortBy('period')
        ->groupBy(fn($c) => $c->period->format('Y-m'));

    // –§–∏–ª—å—Ç—Ä—É–µ–º –ø–ª–∞—Ç–µ–∂–∏ –ø–æ –≥–æ–¥—É
    $payments = $apartment->payments
        ->filter(fn($p) => $p->payment_date->year == $year)
        ->sortBy('payment_date')
        ->groupBy(fn($p) => $p->payment_date->format('Y-m'));

    return view('apartments.show', compact(
        'apartment',
        'charges',
        'payments',
        'years',
        'year'
    ));
}
```

–¢–µ–ø–µ—Ä—å –≤ Blade –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

* `$year` ‚Äî —Ç–µ–∫—É—â–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–¥
* `$years` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ª–µ—Ç
* `$charges` ‚Äî —Ç–æ–ª—å–∫–æ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–¥
* `$payments` ‚Äî —Ç–æ–ª—å–∫–æ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–¥

---

# ‚úÖ 2. –û–±–Ω–æ–≤–ª—è–µ–º Blade ‚Äî –≤—ã–±–æ—Ä –≥–æ–¥–∞

`resources/views/apartments/show.blade.php`

–î–æ–±–∞–≤–ª—è–µ–º –≤—ã–±–æ—Ä –≥–æ–¥–∞ –ø–µ—Ä–µ–¥ –≤—ã–≤–æ–¥–æ–º –¥–∞–Ω–Ω—ã—Ö:

```blade
<div class="container">

    <h2 class="mb-3">{{ $apartment->name }}</h2>
    <p class="text-muted">{{ $apartment->address }}</p>

    <div class="card mb-4">
        <div class="card-body d-flex justify-content-between align-items-center">

            <h4 class="mb-0">–î–∞–Ω–Ω—ã–µ –∑–∞ {{ $year }} –≥–æ–¥</h4>

            <form method="GET" action="{{ route('apartments.show', $apartment->id) }}" class="d-flex">
                <select name="year" class="form-select me-2" onchange="this.form.submit()">
                    @foreach($years as $y)
                        <option value="{{ $y }}" {{ $y == $year ? 'selected' : '' }}>
                            {{ $y }}
                        </option>
                    @endforeach
                </select>

                <noscript>
                    <button class="btn btn-primary">–ü–æ–∫–∞–∑–∞—Ç—å</button>
                </noscript>
            </form>

        </div>
    </div>
```

–≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç —É–¥–æ–±–Ω—ã–π —Å–µ–ª–µ–∫—Ç–æ—Ä –≥–æ–¥–∞.

---

# ‚úÖ 3. –í—ã–≤–æ–¥ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π –∏ –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ –º–µ—Å—è—Ü–∞–º

–î–∞–ª–µ–µ –∑–∞–º–µ–Ω—è–µ–º —Å—Ç–∞—Ä—ã–π –≤—ã–≤–æ–¥ –Ω–∞ –Ω–æ–≤—ã–π:

```blade
<h4 class="mt-4">–ù–∞—á–∏—Å–ª–µ–Ω–∏—è</h4>

@forelse ($charges as $month => $items)
    <div class="card mb-3">
        <div class="card-header">
            <strong>{{ \Carbon\Carbon::createFromFormat('Y-m', $month)->translatedFormat('F Y') }}</strong>
        </div>
        <ul class="list-group list-group-flush">
            @foreach ($items as $charge)
                <li class="list-group-item d-flex justify-content-between">
                    <span>{{ $charge->service->name }}</span>
                    <span>{{ number_format($charge->amount, 2, ',', ' ') }} ‚ÇΩ</span>
                </li>
            @endforeach
        </ul>
    </div>
@empty
    <p class="text-muted">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞ {{ $year }} –≥–æ–¥.</p>
@endforelse


<h4 class="mt-4">–ü–ª–∞—Ç–µ–∂–∏</h4>

@forelse ($payments as $month => $items)
    <div class="card mb-3">
        <div class="card-header">
            <strong>{{ \Carbon\Carbon::createFromFormat('Y-m', $month)->translatedFormat('F Y') }}</strong>
        </div>
        <ul class="list-group list-group-flush">
            @foreach ($items as $payment)
                <li class="list-group-item d-flex justify-content-between">
                    <span>{{ $payment->service->name ?? '–ü–ª–∞—Ç–µ–∂' }}</span>
                    <span>{{ number_format($payment->amount, 2, ',', ' ') }} ‚ÇΩ</span>
                </li>
            @endforeach
        </ul>
    </div>
@empty
    <p class="text-muted">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞ {{ $year }} –≥–æ–¥.</p>
@endforelse
```

---

# üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å:

‚úî –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–¥
‚úî —Ç–µ–∫—É—â–∏–π –≥–æ–¥ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
‚úî –µ—Å—Ç—å –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –≥–æ–¥–æ–≤
‚úî –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –≥–æ–¥–∞–º–∏
‚úî –≤—ã–≤–æ–¥ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω –ø–æ –º–µ—Å—è—Ü–∞–º

---

# –•–æ—á–µ—à—å, —è –¥–æ–±–∞–≤–ª—é:

* **–∫–Ω–æ–ø–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ ¬´‚üµ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –≥–æ–¥ / —Å–ª–µ–¥—É—é—â–∏–π –≥–æ–¥¬ª**
* **–∫—Ä–∞—Å–∏–≤—É—é –¥–∏–∞–≥—Ä–∞–º–º—É –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –≥–æ–¥—É**
* **–∏—Ç–æ–≥–∏ –∑–∞ –≥–æ–¥ (–Ω–∞—á–∏—Å–ª–µ–Ω–æ / –æ–ø–ª–∞—á–µ–Ω–æ / –¥–æ–ª–≥)**

–°–∫–∞–∂–∏ ‚Äî –∏ —Å–¥–µ–ª–∞—é.

---

[–ü—Ä–µ–¥—ã–¥—É—â–∞—è —á–∞—Å—Ç—å](23.md) | [–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](01.md) | [–°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å](25.md)



## –ú–µ–Ω—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤

–°–µ–π—á–∞—Å —Ñ–∞–π–ª—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤—Å–µ –≤ –∫—É—á–µ, –Ω—É–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –ø–æ –≥–æ–¥–∞–º –∏ –º–µ—Å—è—Ü–∞–º

–û—Ç–ª–∏—á–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ üëç
–¢—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤ ‚Äî **—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—ë –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ –Ω–µ–ª—å–∑—è**, –µ—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –∂–∏–≤—ë—Ç –¥–æ–ª—å—à–µ –ø–∞—Ä—ã –º–µ—Å—è—Ü–µ–≤.

–°–¥–µ–ª–∞–µ–º **–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ö—Ä–∞–Ω–µ–Ω–∏—è**:

```
storage/app/public/receipts/
‚îú‚îÄ‚îÄ 2024/
‚îÇ   ‚îú‚îÄ‚îÄ 01/
‚îÇ   ‚îú‚îÄ‚îÄ 02/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ 2025/
‚îÇ   ‚îú‚îÄ‚îÄ 01/
‚îÇ   ‚îú‚îÄ‚îÄ 02/
‚îÇ   ‚îî‚îÄ‚îÄ ...
```

üìå –ì–æ–¥ –∏ –º–µ—Å—è—Ü –±—É–¥–µ–º –±—Ä–∞—Ç—å **–∏–∑ –ø–µ—Ä–∏–æ–¥–∞ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è**, –∞ –Ω–µ –∏–∑ –¥–∞—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏ ‚Äî —ç—Ç–æ –≤–∞–∂–Ω–æ.

---

# üß© –ß—Ç–æ –º–µ–Ω—è–µ–º

–ú–µ–Ω—è–µ–º **–¢–û–õ–¨–ö–û –ª–æ–≥–∏–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞**
–ë–î, —Ñ–æ—Ä–º—ã –∏ UI ‚Äî –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

---

# ‚úÖ –®–ê–ì 1. –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏—è

### –í `ChargeController@store` –∏ `update`

```php
use Illuminate\Support\Facades\Storage;
use Carbon\Carbon;
```

### –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏

```php
$period = $data['period']; // Carbon
$year   = $period->year;
$month  = sprintf('%02d', $period->month);

$directory = "receipts/{$year}/{$month}";
```

---

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞

```php
if ($request->hasFile('receipt')) {

    // —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
    if (isset($charge) && $charge->receipt_path) {
        Storage::disk('public')->delete($charge->receipt_path);
    }

    $data['receipt_path'] = $request->file('receipt')
        ->store($directory, 'public');
}
```

---

# ‚úÖ –®–ê–ì 2. –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä store()

```php
public function store(Request $request)
{
    $data = $request->validate([
        'apartment_id' => 'required',
        'service_id'   => 'required',
        'amount'       => 'required|numeric',
        'month'        => 'required|integer',
        'year'         => 'required|integer',
        'receipt'      => 'nullable|file|mimes:pdf|max:5120',
    ]);

    $data['period'] = Carbon::create($data['year'], $data['month'], 1);
    unset($data['month'], $data['year']);

    if ($request->hasFile('receipt')) {

        $year  = $data['period']->year;
        $month = sprintf('%02d', $data['period']->month);

        $data['receipt_path'] = $request->file('receipt')
            ->store("receipts/{$year}/{$month}", 'public');
    }

    Charge::create($data);

    return back()->with('success', '–ù–∞—á–∏—Å–ª–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ');
}
```

---

# ‚úÖ –®–ê–ì 3. update() (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ)

```php
if ($request->hasFile('receipt')) {

    if ($charge->receipt_path) {
        Storage::disk('public')->delete($charge->receipt_path);
    }

    $year  = $data['period']->year;
    $month = sprintf('%02d', $data['period']->month);

    $data['receipt_path'] = $request->file('receipt')
        ->store("receipts/{$year}/{$month}", 'public');
}
```

---

# üß† –í–ê–ñ–ù–û: –µ—Å–ª–∏ –º–µ–Ω—è–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥

–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **–∏–∑–º–µ–Ω–∏–ª –º–µ—Å—è—Ü/–≥–æ–¥**, –∞ —Ñ–∞–π–ª **–Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª –∑–∞–Ω–æ–≤–æ** ‚Äî
—Ñ–∞–π–ª **–æ—Å—Ç–∞–Ω–µ—Ç—Å—è –≤ —Å—Ç–∞—Ä–æ–π –ø–∞–ø–∫–µ**.

üëâ –≠—Ç–æ **–Ω–æ—Ä–º–∞–ª—å–Ω–æ** –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ.

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å **–ø–µ—Ä–µ–º–µ—â–∞—Ç—å —Ñ–∞–π–ª –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** ‚Äî —Å–∫–∞–∂–∏, —Å–¥–µ–ª–∞–µ–º.

---

# üéâ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å —Ö–æ—Ä–æ—à–æ

‚úî —Ñ–∞–π–ª—ã —Ä–∞–∑–ª–æ–∂–µ–Ω—ã –ø–æ –≥–æ–¥–∞–º –∏ –º–µ—Å—è—Ü–∞–º
‚úî –ª–µ–≥–∫–æ –∏—Å–∫–∞—Ç—å –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏
‚úî –Ω–µ –±—É–¥–µ—Ç 10 000 —Ñ–∞–π–ª–æ–≤ –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ
‚úî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–∫ —É —Ä–µ–∞–ª—å–Ω—ã—Ö –±–∏–ª–ª–∏–Ω–≥–æ–≤

---

## üîú –û—á–µ–Ω—å –ª–æ–≥–∏—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1Ô∏è‚É£ **–ü–æ–¥–ø–∞–ø–∫–∏ –ø–æ –∫–≤–∞—Ä—Ç–∏—Ä–µ**
2Ô∏è‚É£ **–ù–µ—Å–∫–æ–ª—å–∫–æ –∫–≤–∏—Ç–∞–Ω—Ü–∏–π –Ω–∞ –æ–¥–Ω–æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ**
3Ô∏è‚É£ **–ê—Ä—Ö–∏–≤–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –ª–µ—Ç**
4Ô∏è‚É£ **–û—á–∏—Å—Ç–∫–∞ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤**

–•–æ—á–µ—à—å –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å ‚Äî –≤—ã–±–∏—Ä–∞–π –Ω–æ–º–µ—Ä –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–∏ —Å–≤–æ—ë üëå

---

[–ü—Ä–µ–¥—ã–¥—É—â–∞—è —á–∞—Å—Ç—å](40.md) | [–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](01.md) | [–°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å](42.md)



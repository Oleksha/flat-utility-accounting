## –î–æ–≤–æ–¥–∏–º –¥–æ –∫–æ–Ω—Ü–∞ –≤–∫–ª–∞–¥–∫—É ¬´–û–±–∑–æ—Ä¬ª

–ú—ã –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª–∏ —Å –≤–∫–ª–∞–¥–∫–æ–π –û–ë–ó–û–† 

```bladehtml
{{-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≥–æ–¥–∞–º --}}
@include('apartments.partials.year-navigation')
{{-- –ò—Ç–æ–≥–∏ --}}
@include('apartments.partials.year-summary')
{{-- –ì—Ä–∞—Ñ–∏–∫ --}}
@include('apartments.partials.year-chart')
```

–¢—ã –ø—Ä–∞–≤ üëç ‚Äî **–≤–∫–ª–∞–¥–∫—É ¬´–û–±–∑–æ—Ä¬ª –Ω—É–∂–Ω–æ –¥–æ–≤–µ—Å—Ç–∏ –¥–æ –∫–æ–Ω—Ü–∞ –∏ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å**, —á—Ç–æ–±—ã –æ–Ω–∞ –±—ã–ª–∞:

* —Å—Ç–∞–±–∏–ª—å–Ω–æ–π (–±–µ–∑ undefined key)
* –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π –ø–æ UX
* –ª–æ–≥–∏—á–µ—Å–∫–∏ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ–π

–î–∞–≤–∞–π —è **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–±–µ—Ä—É –≤—Å–µ 3 partial‚Äô–∞**, –∫–æ—Ç–æ—Ä—ã–µ —Ç—ã –ø–æ–¥–∫–ª—é—á–∞–µ—à—å, **–≤ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ** —Å —Ç–µ–º, —á—Ç–æ —É–∂–µ –µ—Å—Ç—å –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ.

---

# üß© 1. –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≥–æ–¥–∞–º

`resources/views/apartments/partials/year-navigation.blade.php`

```blade
@php
    $minYear = $years->min();
    $maxYear = $years->max();
@endphp

<div class="d-flex justify-content-between align-items-center mb-4">

    {{-- –ü—Ä–µ–¥—ã–¥—É—â–∏–π –≥–æ–¥ --}}
    <a href="{{ route('apartments.show', [
            'apartment' => $apartment->id,
            'year' => $year - 1
        ]) }}"
       class="btn btn-outline-secondary {{ $year <= $minYear ? 'disabled' : '' }}">
        ‚üµ {{ $year - 1 }}
    </a>

    {{-- –í—ã–±–æ—Ä –≥–æ–¥–∞ --}}
    <form method="GET" action="{{ route('apartments.show', $apartment->id) }}">
        <select name="year"
                class="form-select"
                onchange="this.form.submit()">
            @foreach($years as $y)
                <option value="{{ $y }}" {{ $y == $year ? 'selected' : '' }}>
                    {{ $y }}
                </option>
            @endforeach
        </select>
    </form>

    {{-- –°–ª–µ–¥—É—é—â–∏–π –≥–æ–¥ --}}
    <a href="{{ route('apartments.show', [
            'apartment' => $apartment->id,
            'year' => $year + 1
        ]) }}"
       class="btn btn-outline-secondary {{ $year >= $maxYear ? 'disabled' : '' }}">
        {{ $year + 1 }} ‚ü∂
    </a>

</div>
```

‚úî –Ω–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –≤ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≥–æ–¥–∞
‚úî –∫–Ω–æ–ø–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–∏–∑–µ–π–±–ª—è—Ç—Å—è

---

# üß© 2. –ò—Ç–æ–≥–∏ –∑–∞ –≥–æ–¥

`resources/views/apartments/partials/year-summary.blade.php`

```blade
<div class="row mb-4">

    <div class="col-md-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <div class="text-muted">–ù–∞—á–∏—Å–ª–µ–Ω–æ</div>
                <div class="fs-4">
                    {{ number_format($totalCharges, 2, ',', ' ') }} ‚ÇΩ
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <div class="text-muted">–û–ø–ª–∞—á–µ–Ω–æ</div>
                <div class="fs-4">
                    {{ number_format($totalPayments, 2, ',', ' ') }} ‚ÇΩ
                </div>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <div class="card shadow-sm {{ $debt > 0 ? 'border-danger' : 'border-success' }}">
            <div class="card-body">
                <div class="text-muted">–ë–∞–ª–∞–Ω—Å</div>
                <div class="fs-4 {{ $debt > 0 ? 'text-danger' : 'text-success' }}">
                    {{ number_format($debt, 2, ',', ' ') }} ‚ÇΩ
                </div>
            </div>
        </div>
    </div>

</div>
```

‚úî –∫—Ä–∞—Å–Ω—ã–π ‚Äî –¥–æ–ª–≥
‚úî –∑–µ–ª—ë–Ω—ã–π ‚Äî –ø–µ—Ä–µ–ø–ª–∞—Ç–∞
‚úî —á–∏—Ç–∞–µ–º–æ –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ

---

# üß© 3. –ì—Ä–∞—Ñ–∏–∫ –∑–∞ –≥–æ–¥

`resources/views/apartments/partials/year-chart.blade.php`

```blade
<div class="card mb-4 shadow-sm">
    <div class="card-body">
        <h5 class="mb-3">–ù–∞—á–∏—Å–ª–µ–Ω–∏—è –∏ –ø–ª–∞—Ç–µ–∂–∏ –∑–∞ {{ $year }} –≥–æ–¥</h5>
        <canvas id="yearChart" height="110"></canvas>
    </div>
</div>

@push('scripts')
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {

    const ctx = document.getElementById('yearChart');
    if (!ctx) return;

    new Chart(ctx, {
        type: 'line',
        data: {
            labels: @json($labels),
            datasets: [
                {
                    label: '–ù–∞—á–∏—Å–ª–µ–Ω–∏—è',
                    data: @json($chargesGraph),
                    borderWidth: 2,
                    tension: 0.3
                },
                {
                    label: '–ü–ª–∞—Ç–µ–∂–∏',
                    data: @json($paymentsGraph),
                    borderWidth: 2,
                    tension: 0.3
                }
            ]
        },
        options: {
            plugins: {
                legend: { position: 'bottom' }
            }
        }
    });
});
</script>
@endpush
```

‚úî –≥—Ä–∞—Ñ–∏–∫ –Ω–µ –ø–∞–¥–∞–µ—Ç
‚úî —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ canvas —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
‚úî –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ –≥–æ–¥

---

# ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç: —á—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ

–£–±–µ–¥–∏—Å—å, —á—Ç–æ –≤ `ApartmentController@show` –µ—Å—Ç—å:

```php
$year;
$years;
$totalCharges;
$totalPayments;
$debt;
$labels;
$chargesGraph;
$paymentsGraph;
```

(—É —Ç–µ–±—è –æ–Ω–∏ —É–∂–µ –µ—Å—Ç—å ‚Äî –º—ã –ø—Ä–æ—Å—Ç–æ –≤—Å—ë –∫—Ä–∞—Å–∏–≤–æ –≤—ã–≤–µ–ª–∏)

---

# üéâ –ò—Ç–æ–≥

–í–∫–ª–∞–¥–∫–∞ **üìä –û–±–∑–æ—Ä** —Ç–µ–ø–µ—Ä—å:

‚úî –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–∫–æ–Ω—á–µ–Ω–∞
‚úî —Å—Ç–∞–±–∏–ª—å–Ω–∞
‚úî –≤–∏–∑—É–∞–ª—å–Ω–æ –∞–∫–∫—É—Ä–∞—Ç–Ω–∞
‚úî –ª–æ–≥–∏—á–µ—Å–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–∞

---

## üîú –ß—Ç–æ –ª–æ–≥–∏—á–Ω–æ –¥–∞–ª—å—à–µ?

–Ø –±—ã –ø—Ä–µ–¥–ª–æ–∂–∏–ª:

1Ô∏è‚É£ **–§–æ—Ä–º—ã –ø–ª–∞—Ç–µ–∂–µ–π (create/edit)**
2Ô∏è‚É£ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á—ë—Ç –¥–æ–ª–≥–∞ –ø–æ —É—Å–ª—É–≥–∞–º**
3Ô∏è‚É£ **–≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—á—ë—Ç–∞ –∑–∞ –≥–æ–¥ (PDF / Excel)**
4Ô∏è‚É£ **–î–∞—à–±–æ—Ä–¥ –ø–æ –≤—Å–µ–º –∫–≤–∞—Ä—Ç–∏—Ä–∞–º**

–°–∫–∞–∂–∏ –Ω–æ–º–µ—Ä ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –±–µ–∑ —Ç–æ—Ä–º–æ–∑–æ–≤ üöÄ

---

[–ü—Ä–µ–¥—ã–¥—É—â–∞—è —á–∞—Å—Ç—å](30.md) | [–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](01.md) | [–°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å](32.md)



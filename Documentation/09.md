## Обновление моделей

Хочу.

Отлично! Давай сразу оформим **все модели с fillable и отношениями**, чтобы CRUD для квартир, поставщиков, услуг, тарифов, начислений и платежей работал без ошибок.

---

## **1. Apartment**

```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class Apartment extends Model
{
    use HasFactory;

    protected $fillable = [
        'name',
        'address',
    ];

    public function charges()
    {
        return $this->hasMany(Charge::class);
    }

    public function payments()
    {
        return $this->hasMany(Payment::class);
    }

    public function rates()
    {
        return $this->hasMany(Rate::class);
    }
}
```

---

## **2. Provider**

```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class Provider extends Model
{
    use HasFactory;

    protected $fillable = [
        'name',
        'phone',
        'email',
        'site_url',
    ];

    public function rates()
    {
        return $this->hasMany(Rate::class);
    }
}
```

---

## **3. Service**

```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class Service extends Model
{
    use HasFactory;

    protected $fillable = [
        'name',
    ];

    public function charges()
    {
        return $this->hasMany(Charge::class);
    }

    public function rates()
    {
        return $this->hasMany(Rate::class);
    }
}
```

---

## **4. Rate (Тариф)**

```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class Rate extends Model
{
    use HasFactory;

    protected $fillable = [
        'apartment_id',
        'provider_id',
        'service_id',
        'price',
        'type',
        'start_date',
    ];

    protected $dates = [
        'start_date',
    ];

    public function apartment()
    {
        return $this->belongsTo(Apartment::class);
    }

    public function provider()
    {
        return $this->belongsTo(Provider::class);
    }

    public function service()
    {
        return $this->belongsTo(Service::class);
    }
}
```

---

## **5. Charge (Начисление)**

```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class Charge extends Model
{
    use HasFactory;

    protected $fillable = [
        'apartment_id',
        'service_id',
        'amount',
        'period',
        'comment',
    ];

    protected $dates = [
        'period',
    ];

    public function apartment()
    {
        return $this->belongsTo(Apartment::class);
    }

    public function service()
    {
        return $this->belongsTo(Service::class);
    }
}
```

---

## **6. Payment (Платеж)**

```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class Payment extends Model
{
    use HasFactory;

    protected $fillable = [
        'apartment_id',
        'amount',
        'payment_date',
        'comment',
    ];

    protected $dates = [
        'payment_date',
    ];

    public function apartment()
    {
        return $this->belongsTo(Apartment::class);
    }
}
```

---

✅ **Теперь:**

* Все модели имеют `$fillable` → можно безопасно использовать `$request->all()` в контроллерах.
* Добавлены отношения → удобно получать начисления, платежи, тарифы и услуги.
* Даты (`period`, `payment_date`, `start_date`) приведены к объектам Carbon для форматирования в Blade.

---

Следующим шагом можно сделать **CRUD для тарифов, начислений и платежей с удобными интерфейсами на Blade + Bootstrap**, чтобы весь учет был полностью рабочим.

Хочешь, чтобы я это сделал?

---

[Предыдущая часть](08.md) | [Содержание](01.md) | [Следующая часть](10.md)



–ú–µ—Ç–æ–¥ store —Ç–æ-–∂–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏.

---

–û—Ç–ª–∏—á–Ω–æ, —Ç—É—Ç **—Ç–∞ –∂–µ —Å–∞–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞**, —á—Ç–æ –∏ –≤ `update()` ‚Äî –ø—Ä–æ—Å—Ç–æ –≤ `store()` –æ–Ω–∞ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –µ—â—ë –Ω–∞–≥–ª—è–¥–Ω–µ–µ üëç
–†–∞–∑–±–µ—Ä—ë–º —á—ë—Ç–∫–æ –∏ —Å—Ä–∞–∑—É –¥–∞–¥–∏–º **–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞–±–æ—á–∏–π –∫–æ–¥**.

---

## ‚ùå –ü–æ—á–µ–º—É `store()` –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏

### –ö–ª—é—á–µ–≤–∞—è –æ—à–∏–±–∫–∞

–¢—ã —Å–Ω–æ–≤–∞ –¥–µ–ª–∞–µ—à—å —ç—Ç–æ **–ø–æ —Å—Ç–∞—Ä–æ–π —Å—Ö–µ–º–µ**:

```php
$data['receipt_path'] = ...
Charge::create($data);
```

‚ùå –ù–æ —É —Ç–µ–±—è **–ù–ï–¢ –ø–æ–ª—è `receipt_path` –≤ `charges`**
‚ùå –ö–≤–∏—Ç–∞–Ω—Ü–∏–∏ —Ç–µ–ø–µ—Ä—å ‚Äî **–æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `receipts`**
‚ùå –§–∞–π–ª —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –Ω–æ **–∑–∞–ø–∏—Å—å –æ –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è**

---

## ‚úÖ –ö–∞–∫ –î–û–õ–ñ–ù–û –±—ã—Ç—å (–ª–æ–≥–∏–∫–∞)

1Ô∏è‚É£ –°–æ–∑–¥–∞—ë–º **Charge**
2Ô∏è‚É£ –ï—Å–ª–∏ –µ—Å—Ç—å PDF ‚Üí —Å–æ–∑–¥–∞—ë–º **Receipt**
3Ô∏è‚É£ –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –∫–≤–∏—Ç–∞–Ω—Ü–∏—é –∫ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—é (`attach`)

---

## ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–´–ô `store()` (–ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô)

```php
use App\Models\Charge;
use App\Models\Receipt;
use Illuminate\Support\Facades\Storage;
use Carbon\Carbon;

public function store(Request $request)
{
    $data = $request->validate([
        'apartment_id' => 'required|exists:apartments,id',
        'service_id'   => 'required|exists:services,id',
        'amount'       => 'required|numeric|min:0',
        'month'        => 'required|integer|min:1|max:12',
        'year'         => 'required|integer',
        'comment'      => 'nullable|string|max:255',
        'receipt'      => 'nullable|file|mimes:pdf|max:5120',
    ]);

    $period = Carbon::create(
        $data['year'],
        $data['month'],
        1
    );

    // 1Ô∏è‚É£ —Å–æ–∑–¥–∞—ë–º –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ
    $charge = Charge::create([
        'apartment_id' => $data['apartment_id'],
        'service_id'   => $data['service_id'],
        'amount'       => $data['amount'],
        'period'       => $period,
        'comment'      => $data['comment'] ?? null,
    ]);

    // 2Ô∏è‚É£ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–≤–∏—Ç–∞–Ω—Ü–∏—é
    if ($request->hasFile('receipt')) {

        $year  = $period->year;
        $month = sprintf('%02d', $period->month);

        $path = $request->file('receipt')
            ->store("receipts/{$year}/{$month}", 'public');

        $receipt = Receipt::create([
            'apartment_id'  => $data['apartment_id'],
            'file_path'     => $path,
            'period'        => $period,
            'original_name' => $request->file('receipt')->getClientOriginalName(),
            'note'          => '–ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è',
        ]);

        // 3Ô∏è‚É£ —Å–≤—è–∑—ã–≤–∞–µ–º
        $receipt->charges()->attach($charge->id);
    }

    return redirect()
        ->route('apartments.show', $data['apartment_id'])
        ->with('success', '–ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ');
}
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä—å –º–æ–¥–µ–ª—å Charge

```php
class Charge extends Model
{
    protected $fillable = [
        'apartment_id',
        'service_id',
        'amount',
        'period',
        'comment',
    ];

    protected $casts = [
        'period' => 'date',
    ];

    public function receipts()
    {
        return $this->belongsToMany(Receipt::class);
    }
}
```

---

## üß† –ü–æ—á–µ–º—É —Ç–µ–ø–µ—Ä—å –≤—Å—ë –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

‚úî —Ñ–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
‚úî –∑–∞–ø–∏—Å—å –æ –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è
‚úî `apartment_id` –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è
‚úî —Å–≤—è–∑—å many-to-many —Å–æ–∑–¥–∞—ë—Ç—Å—è
‚úî –∫–≤–∏—Ç–∞–Ω—Ü–∏—è –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ modal
‚úî –æ–¥–Ω–∞ –∫–≤–∏—Ç–∞–Ω—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å —É –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Å–ª—É–≥

---

## üö® –¢–∏–ø–∏—á–Ω—ã–π —Å–∏–º–ø—Ç–æ–º, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ç–∞–∫

| –°–∏–º–ø—Ç–æ–º                  | –ü—Ä–∏—á–∏–Ω–∞              |
| ------------------------ | -------------------- |
| —Ñ–∞–π–ª –µ—Å—Ç—å, –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏ –Ω–µ—Ç | –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è Receipt |
| SQL –æ—à–∏–±–∫–∞               | –∑–∞–±—ã–ª–∏ apartment_id  |
| modal –ø—É—Å—Ç–æ–π             | –Ω–µ—Ç —Å–≤—è–∑–∏ pivot      |
| –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è PDF      | Storage::url / disk  |

---

## üî• –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –Ω–∞ –±—É–¥—É—â–µ–µ

**–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π `receipt_*` –≤ Charge**
Charge ‚Äî —ç—Ç–æ **–±—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∞—è —Å—Ç—Ä–æ–∫–∞**,
Receipt ‚Äî **—Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –¥–æ–∫—É–º–µ–Ω—Ç**.

–¢—ã —É–∂–µ –≤—ã–±—Ä–∞–ª **–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** üí™

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –¥–∞–ª—å—à–µ –º–æ–∂–µ–º:

* —Å–¥–µ–ª–∞—Ç—å **–º–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏ –∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º —É—Å–ª—É–≥–∞–º**
* –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å **—É–¥–∞–ª–µ–Ω–∏–µ –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏ —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º**
* –∏–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É **¬´–í—Å–µ –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏ –∫–≤–∞—Ä—Ç–∏—Ä—ã¬ª**

–ì–æ–≤–æ—Ä–∏, –∏–¥—ë–º –¥–∞–ª—å—à–µ üöÄ

---

–£ –Ω–∞—Å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã –µ—Å—Ç—å –≤–∫–ª–∞–¥–∫–∏ –û–±–∑–æ—Ä, –ù–∞—á–∏—Å–ª–µ–Ω–∏—è, –ü–ª–∞—Ç–µ–∂–∏. –î–∞–≤–∞–π –¥–æ–±–∞–≤–∏–º –µ—â–µ –æ–¥–Ω—É - –£—Å–ª—É–≥–∏ –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç –≥—Ä–∞—Ñ–∏–∫ –ø–æ –≤—Å–µ–º —É—Å–ª—É–≥–∞–º –∑–∞ –≥–æ–¥ –∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –ø–æ –∫–∞–∂–¥–æ–π —É—Å–ª—É–≥–µ –ø–æ –º–µ—Å—è—Ü–∞–º

---

–û—Ç–ª–∏—á–Ω–∞—è –∏–¥–µ—è üëç
–í–∫–ª–∞–¥–∫–∞ **¬´–£—Å–ª—É–≥–∏¬ª** –ª–æ–≥–∏—á–Ω–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç UX –∏ –¥–∞—ë—Ç **–∞–Ω–∞–ª–∏—Ç–∏–∫—É –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ä–∞—Å—Ö–æ–¥–æ–≤**, –∫–∞–∫ –≤ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –ñ–ö–•-–∫–∞–±–∏–Ω–µ—Ç–∞—Ö.

–°–¥–µ–ª–∞–µ–º **–ø–æ–Ω—è—Ç–Ω–æ, –∫—Ä–∞—Å–∏–≤–æ –∏ –±–µ–∑ –ø–µ—Ä–µ–≥—Ä—É–∑–∞**.

---

# üéØ –ß—Ç–æ –±—É–¥–µ—Ç –Ω–∞ –≤–∫–ª–∞–¥–∫–µ ¬´–£—Å–ª—É–≥–∏¬ª

### 1Ô∏è‚É£ –ì—Ä–∞—Ñ–∏–∫ –ø–æ –≤—Å–µ–º —É—Å–ª—É–≥–∞–º –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–¥

* —Å—É–º–º—ã –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π
* —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —É—Å–ª—É–≥ –º–µ–∂–¥—É —Å–æ–±–æ–π
  (—Å—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞)

### 2Ô∏è‚É£ –¢–∞–±–ª–∏—Ü–∞: –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –ø–æ –∫–∞–∂–¥–æ–π —É—Å–ª—É–≥–µ **–ø–æ –º–µ—Å—è—Ü–∞–º**

* —Å—Ç—Ä–æ–∫–∏ ‚Äî —É—Å–ª—É–≥–∏
* –∫–æ–ª–æ–Ω–∫–∏ ‚Äî –º–µ—Å—è—Ü—ã
* –∏—Ç–æ–≥ –ø–æ —É—Å–ª—É–≥–µ –∑–∞ –≥–æ–¥

---

# üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–≤–∞–∂–Ω–æ)

–ú—ã **–Ω–∏—á–µ–≥–æ –Ω–µ —É—Å–ª–æ–∂–Ω—è–µ–º**:

* –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ `charges`
* –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ
* Blade —Ç–æ–ª—å–∫–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç

---

# 1Ô∏è‚É£ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä (`ApartmentController@show`)

–î–æ–±–∞–≤–ª—è–µ–º **–æ—Ç–¥–µ–ª—å–Ω—ã–π –±–ª–æ–∫**, –Ω–µ –ª–æ–º–∞—è —Ç–µ–∫—É—â–µ–µ.

```php
// –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è –∑–∞ –≥–æ–¥ (–¥–ª—è —É—Å–ª—É–≥)
$chargesForServices = $apartment->charges()
    ->with('service')
    ->whereYear('period', $year)
    ->get();
```

### –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞: —É—Å–ª—É–≥–∞ ‚Üí –º–µ—Å—è—Ü ‚Üí —Å—É–º–º–∞

```php
$servicesMatrix = $chargesForServices
    ->groupBy('service.name')
    ->map(function ($items) {
        return $items
            ->groupBy(fn($c) => $c->period->format('Y-m'))
            ->map(fn($m) => $m->sum('amount'));
    });
```

### –ò—Ç–æ–≥–∏ –ø–æ —É—Å–ª—É–≥–∞–º (–¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞)

```php
$servicesTotals = $servicesMatrix
    ->map(fn($months) => $months->sum());
```

–ü–µ—Ä–µ–¥–∞—ë–º –≤ view:

```php
return view('apartments.show', compact(
    // —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
    'apartment',
    'year',
    'years',

    // –Ω–æ–≤–æ–µ
    'servicesMatrix',
    'servicesTotals'
));
```

---

# 2Ô∏è‚É£ –í–∫–ª–∞–¥–∫–∞ –≤ `apartments/show.blade.php`

### –ù–∞–≤–∏–≥–∞—Ü–∏—è

```blade
<ul class="nav nav-tabs mb-3">
    <li class="nav-item">
        <a class="nav-link {{ request('tab') !== 'services' ? 'active' : '' }}"
           href="{{ route('apartments.show', $apartment) }}">
            –û–±–∑–æ—Ä
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link {{ request('tab') === 'charges' ? 'active' : '' }}"
           href="{{ route('apartments.show', [$apartment, 'tab' => 'charges']) }}">
            –ù–∞—á–∏—Å–ª–µ–Ω–∏—è
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link {{ request('tab') === 'payments' ? 'active' : '' }}"
           href="{{ route('apartments.show', [$apartment, 'tab' => 'payments']) }}">
            –ü–ª–∞—Ç–µ–∂–∏
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link {{ request('tab') === 'services' ? 'active' : '' }}"
           href="{{ route('apartments.show', [$apartment, 'tab' => 'services']) }}">
            –£—Å–ª—É–≥–∏
        </a>
    </li>
</ul>
```

---

# 3Ô∏è‚É£ –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–∫–∏ ¬´–£—Å–ª—É–≥–∏¬ª

```blade
@if(request('tab') === 'services')
    @include('apartments.partials.services-tab')
@endif
```

---

# 4Ô∏è‚É£ `services-tab.blade.php`

## üìä –ì—Ä–∞—Ñ–∏–∫ –ø–æ —É—Å–ª—É–≥–∞–º

```blade
<div class="card mb-4">
    <div class="card-header">–ù–∞—á–∏—Å–ª–µ–Ω–∏—è –ø–æ —É—Å–ª—É–≥–∞–º –∑–∞ {{ $year }}</div>
    <div class="card-body">
        <canvas id="servicesChart"></canvas>
    </div>
</div>
```

```blade
<script>
new Chart(document.getElementById('servicesChart'), {
    type: 'bar',
    data: {
        labels: @json($servicesTotals->keys()),
        datasets: [{
            label: '–ù–∞—á–∏—Å–ª–µ–Ω–æ',
            data: @json($servicesTotals->values()),
        }]
    }
});
</script>
```

---

## üìã –¢–∞–±–ª–∏—Ü–∞ –ø–æ –º–µ—Å—è—Ü–∞–º

```blade
<div class="card">
    <div class="card-header">–ù–∞—á–∏—Å–ª–µ–Ω–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º</div>
    <div class="card-body table-responsive">

        <table class="table table-bordered table-sm text-center align-middle">
            <thead>
            <tr>
                <th>–£—Å–ª—É–≥–∞</th>
                @for($m = 1; $m <= 12; $m++)
                    <th>{{ \Carbon\Carbon::create()->month($m)->translatedFormat('M') }}</th>
                @endfor
                <th>–ò—Ç–æ–≥–æ</th>
            </tr>
            </thead>

            <tbody>
            @foreach($servicesMatrix as $service => $months)
                <tr>
                    <td class="text-start">{{ $service }}</td>

                    @for($m = 1; $m <= 12; $m++)
                        @php
                            $key = sprintf('%d-%02d', $year, $m);
                            $value = $months[$key] ?? 0;
                        @endphp
                        <td>{{ $value ?: '‚Äî' }}</td>
                    @endfor

                    <td class="fw-bold">
                        {{ $months->sum() }}
                    </td>
                </tr>
            @endforeach
            </tbody>
        </table>

    </div>
</div>
```

---

# ‚úÖ –ß—Ç–æ –≤ –∏—Ç–æ–≥–µ

‚úî –Ω–æ–≤–∞—è –≤–∫–ª–∞–¥–∫–∞ ¬´–£—Å–ª—É–≥–∏¬ª
‚úî –Ω–∞–≥–ª—è–¥–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ä–∞—Å—Ö–æ–¥–æ–≤
‚úî —Ç–∞–±–ª–∏—Ü–∞ ¬´—É—Å–ª—É–≥–∞ √ó –º–µ—Å—è—Ü¬ª
‚úî –∏—Ç–æ–≥–∏ –ø–æ –∫–∞–∂–¥–æ–π —É—Å–ª—É–≥–µ
‚úî –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Ç–µ–∫—É—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

---

# üöÄ –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –¥–∞–ª—å—à–µ

* üìà –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å **–≥—Ä–∞—Ñ–∏–∫: —Å—Ç–æ–ª–±—Ü—ã / –∫—Ä—É–≥**
* üëÅ –∫–ª–∏–∫ –ø–æ —É—Å–ª—É–≥–µ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –µ—ë –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è
* üí° –ø–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–∞–º–æ–π –¥–æ—Ä–æ–≥–æ–π —É—Å–ª—É–≥–∏
* üìÑ —ç–∫—Å–ø–æ—Ä—Ç –≤ Excel

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –¥–∞–≤–∞–π —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º —Å–¥–µ–ª–∞–µ–º **–∫–ª–∏–∫ –ø–æ —É—Å–ª—É–≥–µ ‚Üí –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—é** üëå

---

–í–∫–ª–∞–¥–∫–∏ –±—ã–ª–∏ –∫–Ω–æ–ø–∫–∞–º–∏ 

---

–û—Ç–ª–∏—á–Ω–æ üëç —Ç–æ–≥–¥–∞ –¥–µ–ª–∞–µ–º **¬´–£—Å–ª—É–≥–∏¬ª –≤ —Ç–æ–º –∂–µ —Å—Ç–∏–ª–µ ‚Äî —á–µ—Ä–µ–∑ Bootstrap Tabs (buttons)**, **–±–µ–∑ `?tab=` –≤ URL** –∏ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã.
–≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–µ–µ –∏ —á–∏—â–µ –¥–ª—è UX.

–ù–∏–∂–µ ‚Äî **–∞–∫–∫—É—Ä–∞—Ç–Ω–æ–µ –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ**.

---

## 1Ô∏è‚É£ –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É ¬´–£—Å–ª—É–≥–∏¬ª –≤ Tabs

```blade
<ul class="nav nav-tabs mb-4" id="apartmentTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active"
                data-bs-toggle="tab"
                data-bs-target="#overview"
                type="button"
                role="tab">
            üìä –û–±–∑–æ—Ä
        </button>
    </li>

    <li class="nav-item" role="presentation">
        <button class="nav-link"
                data-bs-toggle="tab"
                data-bs-target="#charges"
                type="button"
                role="tab">
            üìÑ –ù–∞—á–∏—Å–ª–µ–Ω–∏—è
        </button>
    </li>

    <li class="nav-item" role="presentation">
        <button class="nav-link"
                data-bs-toggle="tab"
                data-bs-target="#payments"
                type="button"
                role="tab">
            üí≥ –ü–ª–∞—Ç–µ–∂–∏
        </button>
    </li>

    {{-- üÜï –£—Å–ª—É–≥–∏ --}}
    <li class="nav-item" role="presentation">
        <button class="nav-link"
                data-bs-toggle="tab"
                data-bs-target="#services"
                type="button"
                role="tab">
            üßæ –£—Å–ª—É–≥–∏
        </button>
    </li>
</ul>
```

---

## 2Ô∏è‚É£ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤–∫–ª–∞–¥–æ–∫ (`tab-content`)

–£–±–µ–¥–∏—Å—å, —á—Ç–æ **–≤—Å–µ –≤–∫–ª–∞–¥–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞**:

```blade
<div class="tab-content">

    {{-- üìä –û–±–∑–æ—Ä --}}
    <div class="tab-pane fade show active" id="overview" role="tabpanel">
        @include('apartments.partials.overview')
    </div>

    {{-- üìÑ –ù–∞—á–∏—Å–ª–µ–Ω–∏—è --}}
    <div class="tab-pane fade" id="charges" role="tabpanel">
        @include('apartments.partials.charges-list')
    </div>

    {{-- üí≥ –ü–ª–∞—Ç–µ–∂–∏ --}}
    <div class="tab-pane fade" id="payments" role="tabpanel">
        @include('apartments.partials.payments-list')
    </div>

    {{-- üÜï –£—Å–ª—É–≥–∏ --}}
    <div class="tab-pane fade" id="services" role="tabpanel">
        @include('apartments.partials.services-tab')
    </div>

</div>
```

---

## 3Ô∏è‚É£ `services-tab.blade.php` (–∏—Ç–æ–≥–æ–≤—ã–π –≤–∏–¥)

### üìä –ì—Ä–∞—Ñ–∏–∫ –ø–æ —É—Å–ª—É–≥–∞–º

```blade
<div class="card mb-4">
    <div class="card-header">
        –ù–∞—á–∏—Å–ª–µ–Ω–∏—è –ø–æ —É—Å–ª—É–≥–∞–º –∑–∞ {{ $year }}
    </div>
    <div class="card-body">
        <canvas id="servicesChart" height="120"></canvas>
    </div>
</div>
```

```blade
<script>
document.addEventListener('shown.bs.tab', function (e) {
    if (e.target.dataset.bsTarget !== '#services') return;

    if (window.servicesChartInitialized) return;
    window.servicesChartInitialized = true;

    new Chart(document.getElementById('servicesChart'), {
        type: 'bar',
        data: {
            labels: @json($servicesTotals->keys()),
            datasets: [{
                label: '–ù–∞—á–∏—Å–ª–µ–Ω–æ',
                data: @json($servicesTotals->values()),
            }]
        }
    });
});
</script>
```

> ‚ö†Ô∏è –í–ê–ñ–ù–û: –≥—Ä–∞—Ñ–∏–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–∫–∏**
> –∏–Ω–∞—á–µ Canvas –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º

---

## 4Ô∏è‚É£ –¢–∞–±–ª–∏—Ü–∞ ¬´—É—Å–ª—É–≥–∞ √ó –º–µ—Å—è—Ü¬ª

```blade
<div class="card">
    <div class="card-header">
        –ù–∞—á–∏—Å–ª–µ–Ω–∏—è –ø–æ –º–µ—Å—è—Ü–∞–º
    </div>

    <div class="card-body table-responsive">
        <table class="table table-bordered table-sm text-center align-middle">
            <thead>
            <tr>
                <th class="text-start">–£—Å–ª—É–≥–∞</th>
                @for($m = 1; $m <= 12; $m++)
                    <th>
                        {{ \Carbon\Carbon::create()->month($m)->translatedFormat('M') }}
                    </th>
                @endfor
                <th>–ò—Ç–æ–≥–æ</th>
            </tr>
            </thead>

            <tbody>
            @foreach($servicesMatrix as $service => $months)
                <tr>
                    <td class="text-start">{{ $service }}</td>

                    @for($m = 1; $m <= 12; $m++)
                        @php
                            $key = sprintf('%d-%02d', $year, $m);
                            $value = $months[$key] ?? 0;
                        @endphp
                        <td>{{ $value ?: '‚Äî' }}</td>
                    @endfor

                    <td class="fw-bold">
                        {{ number_format($months->sum(), 2, '.', ' ') }}
                    </td>
                </tr>
            @endforeach
            </tbody>
        </table>
    </div>
</div>
```

---

## ‚úÖ –ß—Ç–æ —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ

‚úî –≤–∫–ª–∞–¥–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
‚úî —Å—Ç–∏–ª—å –µ–¥–∏–Ω—ã–π
‚úî –≥—Ä–∞—Ñ–∏–∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∏—Å—É–µ—Ç—Å—è
‚úî –¥–∞–Ω–Ω—ã–µ –Ω–µ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è
‚úî UX ¬´–∫–∞–∫ –≤ –±–∞–Ω–∫–æ–≤—Å–∫–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ¬ª

---

## üöÄ –ß—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–∞–ª—å—à–µ

* üîÅ –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏ (localStorage)
* üìà –∫—Ä—É–≥–æ–≤—É—é –¥–∏–∞–≥—Ä–∞–º–º—É —É—Å–ª—É–≥
* üëÅ –∫–ª–∏–∫ –ø–æ —É—Å–ª—É–≥–µ ‚Üí –µ—ë –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è
* üì§ —ç–∫—Å–ø–æ—Ä—Ç —Ç–∞–±–ª–∏—Ü—ã –≤ Excel

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –¥–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º **–∫–ª–∏–∫ –ø–æ —É—Å–ª—É–≥–µ ‚Üí –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—é** –∏–ª–∏ **–∫—Ä—É–≥–æ–≤—É—é –¥–∏–∞–≥—Ä–∞–º–º—É** üëå

---

[–ü—Ä–µ–¥—ã–¥—É—â–∞—è —á–∞—Å—Ç—å](53.md) | [–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](01.md) | [–°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å](55.md)



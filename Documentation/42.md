## –û–¥–Ω–∞ –∫–≤–∏—Ç–∞–Ω—Ü–∏—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Å–ª—É–≥

–ï—Å–ª–∏ –æ–¥–Ω–∞ –∫–≤–∏—Ç–∞–Ω—Ü–∏—è –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Å–ª—É–≥

–û—Ç–ª–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å ‚Äî —ç—Ç–æ **–æ—á–µ–Ω—å —Ä–µ–∞–ª—å–Ω—ã–π –∫–µ–π—Å** üëç
–ò —Ç—ã –≤–æ–≤—Ä–µ–º—è –æ –Ω—ë–º –∑–∞–¥—É–º–∞–ª—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç–µ–∫—É—â–µ–µ —Ä–µ—à–µ–Ω–∏–µ (`receipt_path` –≤ `charges`) **–ª–æ–≥–∏—á–µ—Å–∫–∏ –Ω–µ–≤–µ—Ä–Ω–æ** –¥–ª—è —Ç–∞–∫–∏—Ö –∫–≤–∏—Ç–∞–Ω—Ü–∏–π.

–î–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º **–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É**, –∫–∞–∫ –≤ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –±–∏–ª–ª–∏–Ω–≥–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö.

---

# üéØ –ü—Ä–æ–±–ª–µ–º–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

–°–µ–π—á–∞—Å:

* ‚ùå **1 –∫–≤–∏—Ç–∞–Ω—Ü–∏—è = 1 –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ**

–í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏:

* ‚úÖ **1 –∫–≤–∏—Ç–∞–Ω—Ü–∏—è = –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Å–ª—É–≥**
* –æ–¥–Ω–∞ PDF:

    * —Å–≤–µ—Ç
    * –≤–æ–¥–∞
    * –æ—Ç–æ–ø–ª–µ–Ω–∏–µ
    * —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

üëâ –ó–Ω–∞—á–∏—Ç, –∫–≤–∏—Ç–∞–Ω—Ü–∏—è ‚Äî **–æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å**, –∞ –Ω–µ –ø–æ–ª–µ –≤ `charges`.

---

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –ú–û–î–ï–õ–¨ –î–ê–ù–ù–´–•

## üß© –ù–æ–≤–∞—è —Å—É—â–Ω–æ—Å—Ç—å: `Receipt`

```
Apartment
   ‚îú‚îÄ‚îÄ Charges
   ‚îî‚îÄ‚îÄ Receipts
           ‚îî‚îÄ‚îÄ belongsToMany Charges
```

### –°–≤—è–∑—å:

* **Receipt ‚Üî Charges** ‚Üí `many-to-many`

---

# üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ (–æ—Å—Ç–∞–µ—Ç—Å—è —Ö–æ—Ä–æ—à–µ–π)

```
storage/app/public/receipts/
‚îî‚îÄ‚îÄ {apartment_id}/
    ‚îî‚îÄ‚îÄ 2025/
        ‚îî‚îÄ‚îÄ 01/
            ‚îî‚îÄ‚îÄ receipt_123.pdf
```

---

# üõ† –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø (–ø–æ —à–∞–≥–∞–º)

---

## ‚úÖ –®–ê–ì 1. –¢–∞–±–ª–∏—Ü–∞ `receipts`

```bash
php artisan make:model Receipt -m
```

```php
Schema::create('receipts', function (Blueprint $table) {
    $table->id();
    $table->foreignId('apartment_id')->constrained()->cascadeOnDelete();
    $table->date('period'); // –º–µ—Å—è—Ü –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏
    $table->string('file_path');
    $table->string('original_name')->nullable();
    $table->timestamps();
});
```

```bash
php artisan migrate
```

---

## ‚úÖ –®–ê–ì 2. Pivot-—Ç–∞–±–ª–∏—Ü–∞ `charge_receipt`

```bash
php artisan make:migration create_charge_receipt_table
```

```php
Schema::create('charge_receipt', function (Blueprint $table) {
    $table->id();
    $table->foreignId('charge_id')->constrained()->cascadeOnDelete();
    $table->foreignId('receipt_id')->constrained()->cascadeOnDelete();
});
```

```bash
php artisan migrate
```

---

## ‚úÖ –®–ê–ì 3. –ú–æ–¥–µ–ª–∏

### Receipt.php

```php
class Receipt extends Model
{
    protected $fillable = [
        'apartment_id',
        'period',
        'file_path',
        'original_name',
    ];

    protected $casts = [
        'period' => 'date',
    ];

    public function charges()
    {
        return $this->belongsToMany(Charge::class);
    }

    public function apartment()
    {
        return $this->belongsTo(Apartment::class);
    }
}
```

### Charge.php

```php
public function receipts()
{
    return $this->belongsToMany(Receipt::class);
}
```

---

# üé® UX: –∫–∞–∫ —ç—Ç–æ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å

## –í–∞—Ä–∏–∞–Ω—Ç (–†–ï–ö–û–ú–ï–ù–î–£–Æ): **–∫–≤–∏—Ç–∞–Ω—Ü–∏—è ‚Üí –ø—Ä–∏–≤—è–∑–∫–∞ —É—Å–ª—É–≥**

### 1Ô∏è‚É£ –ó–∞–≥—Ä—É–∂–∞–µ—à—å –∫–≤–∏—Ç–∞–Ω—Ü–∏—é

* –∫–≤–∞—Ä—Ç–∏—Ä–∞
* –º–µ—Å—è—Ü
* PDF

### 2Ô∏è‚É£ –í—ã–±–∏—Ä–∞–µ—à—å —É—Å–ª—É–≥–∏ (—á–µ–∫–±–æ–∫—Å—ã)

* —Å–≤–µ—Ç
* –≤–æ–¥–∞
* –æ—Ç–æ–ø–ª–µ–Ω–∏–µ

‚úî –∫–≤–∏—Ç–∞–Ω—Ü–∏—è –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç—Å—è —Å—Ä–∞–∑—É –∫–æ –≤—Å–µ–º –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è–º

---

# üßæ –ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º—ã –∑–∞–≥—Ä—É–∑–∫–∏ –∫–≤–∏—Ç–∞–Ω—Ü–∏–∏

```blade
<form method="POST"
      action="{{ route('receipts.store') }}"
      enctype="multipart/form-data">
    @csrf

    <input type="hidden" name="apartment_id" value="{{ $apartment->id }}">

    {{-- –ú–µ—Å—è—Ü --}}
    <input type="month" name="period" class="form-control mb-2">

    {{-- PDF --}}
    <input type="file" name="file" accept="application/pdf" class="form-control mb-2">

    {{-- –£—Å–ª—É–≥–∏ --}}
    @foreach($chargesForMonth as $charge)
        <div class="form-check">
            <input type="checkbox"
                   name="charges[]"
                   value="{{ $charge->id }}"
                   class="form-check-input">
            <label class="form-check-label">
                {{ $charge->service->name }} ‚Äî {{ $charge->amount }} ‚ÇΩ
            </label>
        </div>
    @endforeach

    <button class="btn btn-primary mt-3">–ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–≤–∏—Ç–∞–Ω—Ü–∏—é</button>
</form>
```

---

# üì¶ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä (–∫—Ä–∞—Ç–∫–æ)

```php
$receipt = Receipt::create([
    'apartment_id' => $data['apartment_id'],
    'period'       => $period,
    'file_path'    => $path,
    'original_name'=> $file->getClientOriginalName(),
]);

$receipt->charges()->sync($data['charges']);
```

---

# üéâ –ß—Ç–æ —Ç—ã –≤—ã–∏–≥—Ä—ã–≤–∞–µ—à—å

‚úî –æ–¥–Ω–∞ –∫–≤–∏—Ç–∞–Ω—Ü–∏—è ‚Üí –º–Ω–æ–≥–æ —É—Å–ª—É–≥
‚úî –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö
‚úî –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
‚úî –º–æ–∂–Ω–æ:

* –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–≤–∏—Ç–∞–Ω—Ü–∏–π –≤ –º–µ—Å—è—Ü
* –∑–∞–º–µ–Ω—è—Ç—å PDF
* –ø—Ä–∏–∫—Ä–µ–ø–ª—è—Ç—å –ø–æ–∑–∂–µ

---

# üîú –°–ª–µ–¥—É—é—â–∏–µ –ª–æ–≥–∏—á–Ω—ã–µ —à–∞–≥–∏

1Ô∏è‚É£ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–≤–∏—Ç–∞–Ω—Ü–∏–π –≤ ¬´–û–±–∑–æ—Ä–µ¬ª
2Ô∏è‚É£ Drag & Drop –∑–∞–≥—Ä—É–∑–∫–∞
3Ô∏è‚É£ –ê–≤—Ç–æ–ø–æ–∏—Å–∫ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π –ø–æ –º–µ—Å—è—Ü—É
4Ô∏è‚É£ OCR / —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ PDF (–≤ –±—É–¥—É—â–µ–º)

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –¥–∞–ª—å—à–µ —Å–¥–µ–ª–∞–µ–º **UI –∑–∞–≥—Ä—É–∑–∫–∏ –∫–≤–∏—Ç–∞–Ω—Ü–∏–π –ø—Ä—è–º–æ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–≤–∞—Ä—Ç–∏—Ä—ã** –∏–ª–∏ **–º–∏–≥—Ä–∞—Ü–∏—é —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤**.

---

[–ü—Ä–µ–¥—ã–¥—É—â–∞—è —á–∞—Å—Ç—å](41.md) | [–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](01.md) | [–°–ª–µ–¥—É—é—â–∞—è —á–∞—Å—Ç—å](43.md)


